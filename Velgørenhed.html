<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Velgørenhed</title>
    <link rel="stylesheet" type="text/css" href="velgørenhed.css"/>
</head>
<body>

<form action="/action_page.php" method="get">
    <h2>Velgørenhed</h2>
    <fieldset>
        <legend>Donation amount (kr.)</legend>
        <input type="text" name="amount" value="10.00" />
    </fieldset>
    <fieldset>
        <legend>Hvem vil du donere til?</legend>
        <input type="checkbox" name="organisation" value="WHO" checked>
        Vælg velgørenhedsorganisation WHO<br>
        <input type="checkbox" name="organisation" value="Plastic Change" checked>
        Vælg velgørenhedsorganisation Plastic Change<br>
        <input type="checkbox" name="organisation" value="Sea Turtle Conservancy" checked>
        Vælg velgørenhedsorganisation Sea Turtle Conservancy<br>
    </fieldset>
    <input type="button" id="calc-btn" value="Doner" />
    <div class="result-display"> Donation til de valgte organisationer: <span id="result">0</span> kr.</div>
</form>

<script>
    const form = document.forms[0];

    form.elements['calc-btn'].addEventListener('click', function() {
        let total = parseInt(form.elements['amount'].value, 10);
        let count = selectedCheckboxes(form, 'organisation').length;
        document.getElementById('result').textContent = average(total, count).toFixed(2);
    });

    triggerEvent(form.elements['calc-btn'], 'click'); // Calculate on load

    function average(total, count) {
        return count > 0 ? total / count : 0;
    }

    function selectedCheckboxes(form, name) {
        return Array.from(form.elements[name]).filter(c => c.checked);
    }

    function triggerEvent(el, eventName) {
        var event = document.createEvent('HTMLEvents');
        event.initEvent(eventName, true, false);
        el.dispatchEvent(event);
    }
</script>

</body>
</html>